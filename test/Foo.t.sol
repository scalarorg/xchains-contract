// SPDX-License-Identifier: UNLICENSED
pragma solidity >=0.8.0 <0.9.0;

import { Test } from "forge-std/src/Test.sol";
import { console2 } from "forge-std/src/console2.sol";

contract Encoder is Test {
    string psbtBase64 =
        "cHNidP8BAFICAAAAAVrQluj7zrZI/RJ4h3pXKY5UQckb3hm1I7h+rwqUVXwJAAAAAAD9////AXImAAAAAAAAFgAUUNzsoVipyHLrQF1SKT01ERBXLJ4AAAAAAAEBKw8nAAAAAAAAIlEgkFj0s5tPU4QO+QWJFepTzvTiZxWVJMmxkN+zd/AYnZsBCP0qAQRAcLcPcAUzemcCvpzEo2FQK1NDQJ78/EHqIlXurFNBq4fau6zYbhnXnwPocabdeapr+WfBxW4PNsiXyI2lI4fVz0Dz1lfh+2lyuJkt+WBV0nKW/kGhhdNEhrd65rP82HzaMYVbeqxDCxU9vbQwN5EfzPbwEN47GINB3Fqmql4Rst6+RCAq4x6ocJrtqBlLo+L35+leaA6LZRNciYPAopjRe8U1Cq0gz13/V6FzxayDI8S6yj//ByjrcW858OWmAxIyDNKTWwysYcFQkpt0waBJVLeLS2A16XpeB4paDyjsltVHv+6azoA6wHiAUOedUwY3sr+WPseec56keJeLd7NiZJQ54gBFzctWbuUzR7zr5sTFLwsZS4rDpY/r4NGsZSJ8e0sUIO5JEcwAAA==";

    function testDecode() public view {
        bytes memory psbt = abi.encode(psbtBase64);
        string memory decodedPsbt = abi.decode(psbt, (string));
        console2.logString(decodedPsbt);
        assertEq(decodedPsbt, psbtBase64);
    }

    function testDecodeFromHex() public view {
        bytes memory psbt =
            hex"0000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000000000000000000000000000000000000024C63484E6964503842414649434141414141554D3252384C4F76394431616343725143346739726543682B337530436B707268512F4347727A5946724B41414141414144392F2F2F2F41536369414141414141414146674155554E7A736F56697079484C72514631534B543031455242584C4A344141414141414145424B3851694141414141414141496C45675569506F754139313941726D2F6D6C64355556756C5934484655653343557669646D7444434A79554F4852424643726A487168776D75326F4755756A3476666E3656356F446F746C4531794A673843696D4E46377854554B4771707766316F61562F385745462B75756E4C31563669574F7069746C4C4F4E6A682B4F7564334976696C414B61302F564E626E6B44746A45414F456C434E7745636E754A43596C4764776A6650782B4749677A59553856465165585A4C2B467A384E764F436C56373351704E63646A4F5A476E4148684A2B4D6D39736C744335324956775643536D3354426F456C557434744C59445870656C3448696C6F504B4F79573155652F3770724F6744724146754975696F4E4D42616363354158436B50706D6D6C4D41514A523765736D66482F50474C576D575832356D52306448486C31574B6E496D4C3869714433582F5655527A4C7138337772434844745933415A6370456B55674B754D65714843613761675A53365069392B6670586D674F6932555458496D44774B4B59305876464E51717449504E595A3036387A6D69444B734D43754337487A6B366333592B465A6F544B5056525768714A4176685859724D414141413D3D0000000000000000000000000000000000000000";

        string memory decodedPsbt = abi.decode(psbt, (string));
        console2.log("decodedPsbt: ", decodedPsbt);
    }
}
